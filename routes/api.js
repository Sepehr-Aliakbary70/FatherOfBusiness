<<<<<<< HEAD
var fs = require('fs');
var data = JSON.parse(fs.readFileSync('../content.json', 'utf8'));

=======
var data = {
    "posts": [{
        "title": "سفر به اصالت، جشن های باستانی آریایی",
        "text": "ایران، دیاری همیشه جاوید با هزاران نقش و خط مانده در یاد است. سرزمینی با گنجینه ای عظیم از هنر و فرهنگ که نه تنها تاریخ بلکه زمان را شرمنده خود کرده است. خاستگاه جشن و سرور با پارسیانی نیکو تبار که برای شادی های زندگی ارزش ها قائل بودند و با طبع لطیف و شادی آفرینشان جشن ها آفریدند. شادی هایی برخاسته از هویت مان که شماری را گرامی داشته ایم و بخشی را به فراموشی سپرده ایم. این جشن ها منطبق با تقویم طبیعی بوده و با تغییرات فصلی و اقلیمی پیوندی نا گسستنی دارند. در مجموع جشن های ایران باستان را می توان در سه گروه تقسیم بندی کرد: جشن های ماهانه، سالانه و گاهنبار. جشن های گاهنبار یا گهنبار جشن هایی برای بزرگداشت آفرینش بوده است. بر اساس باورهای سنتی ایرانیان اهورامزدا جهان را در شش مرحله ( شش گاه) آفریده است. هر گاه نامی داشته است که به مدت 5 روز آن را جشن می گرفتند. این جشن ها در گذشته در تمام ایران برپا می شد و امروزه بین زرتشتیان با همان شکوه برگزار می شود. در ادامه نام و زمان جشن های گاهنبار آورده شده است. - گاهنبار اول، میدیوزرم، آفرینش آسمانها، در روز پانزدهم اردیبهشت،چهل و پنجمین روز از اول سال - گاهنبار دوم، میدیوشم، آفرینش زمین، در روز پانزدهم تیر، صد و پنجمین روز سال - گاهنبار سوم، پتیه شهیم، آفرینش آب، در روز سی ام شهریور، صد و هشتادمین روز سال - گاهنبار چهارم، ایاسرم، آفرینش درختان و گیاهان، در روز سی ام مهر، دویست و دهمین روز سال - گاهنبار پنجم، میدیارم، آفرینش حیوانات، در بیستم دیماه، دویست و نودمین روز سال - گاهنبار ششم، همسپتمدم، آفرینش آدم، در سیصد و شصت امین روز سال در پایان 12 ماه اکثر جشن هایی که امروزه هنوز به آن پایبندیم جشن های سالانه است. طبق متون اوستایی سال ایرانی به دو قسمت مساوی تقسیم می شده است که آغاز تابستان را با نوروز و زمستان را با مهرگان جشن می گرفتند. بنابراین این دو جشن که قدمت آن ها به پیش از ظهور زرتشت می رسد جز جشن های سالانه آریائیان ایران زمین بوده که هم چنان پاس داشته شده است. نوروز جشن اعتدال فصلی و آغاز بهار است. از کهن ترین و تحسین شده ترین شادی های جهان، جشنی در مدح طبیعت که پیام آور صلح و دوستی برای بشریت است. 5 روز اول فروردین نوروز کوچک نام داشته که عامه مردم در آن به شادی می پرداختند و از روز ششم که تولد زرتشت بوده نوروز بزرگ آغاز می شده است. در این روز زرتشتیان در آتشکده ها گرد هم آمده و تولد پیامبرشان را جشن می گیرند.",
        "image": 'bn1'
    }, {
        "title": "سفر و هواشناسی",
        "text": "شرایط جوی و هوا از مهم ترین مواردی است که در حال و هوای سفرتان تأثیر چشمگیری دارد. اهمیت این شرایط تا حدی است که در مواردی می تواند تعیین کننده مقصد انتخابی شما باشد. بنابراین لازم است که قبل از سفر به خوبی گزارش هواشناسی را برای روزهای آینده بررسی کنید؛ شاید مجبور به لغو سفر و یا تغییر مسیر حرکت تان شوید. علاوه بر این دانستن شرایط هوا در حین سفر به خصوص اگر قصد طبیعت گردی داشته باشید؛ اهمیتی دو چندان دارد. چرا که سفر به طبیعت با همه زیبایی هایش ممکن است با خطراتی همراه باشد. * از جمله اطلاعاتی که می تواند برایتان بسیار مفید واقع شود؛ شناختن انواع ابراها است که آگاهی از آن به شما قدرت پیش بینی و تصمیم گیری می دهد. هر ابری برای خود زبانی دارد ؛ برخی از ابرها نشان از طوفان و شرایط بد جوی دارند. این ابرها معمولا سیاه و خاکستری رنگ هستند و در نزدیکی زمین قرار دارند؛ در صورتی که در طبیعت با اینگونه ابرها موجه شدید؛ بهتر است که آن مکان را ترک کنید. این شرایط اکثرا در بعد از ظهر و در دامنه کوهها و نواحی کوهستانی رخ می دهد. * تغییر جهت وزش باد نکته دیگری است که از وقوع احتمالی طوفان و بد شدن هوا حکایت می کند. * محل اقامت در طبیعت مورد با اهمیت دیگری است. برای نمونه ویلاهایی که در حریم رودخانه قرار دارند جای مناسبی برای اقامت نیستند. چرا که در صورت وقوع سیل، ساکنین این ویلاها در معرض بیشترین خطر قرار دارند. با انتخاب نکردن این اماکن اقامتی هم از امنیت خود در سفر مطمئن هستید و هم باعث بی تقاضا ماندن این ویلاها و جلوگیری از افزایش تعدادشان خواهید شد.",
        "image": 'bn2'
    }, {
        "title": "پاییز را در یابیم",
        "text": "کاروان خزان نرم و نرم و دزدانه از راه رسیده است تا با معجون رنگ های دیوانه کننده اش دوباره تو را افسون خود کند و با باران برگ های طلایی و قدم زدن بر روی یک دنیا رنگ تو را به اوج احساس برد. بهار عاشق آمده است و با خود بوی باران و رنگ، بوی خاک و برگ آورده است تا بی عشق عاشقت کند و با زیبایی ها آشتی ات دهد. خزان که می وزد در کوچه پس کوچه های ابیانه می توان بوی نوی اصالت را استشمام کرد و همزمان از بازی رنگ و برگ به وجد آمد.",
        "image": 'bn3'
    }]
};
>>>>>>> aa34523e29c577f9f9d008989792a8efbe4fcdf1

// GET
if (typeof localStorage === "undefined" || localStorage === null) {
    var LocalStorage = require('node-localstorage').LocalStorage;
    localStorage = new LocalStorage('./scratch');

}
exports.posts = function(req, res) {
    var posts = [];
<<<<<<< HEAD
    data.forEach(function(post, i) {
        posts.push({
            id: i,
            SeasenNumber : post.SeasenDetile.SeasenNumber,
            SeasenTitle: post.SeasenDetile.SeasenTitle,
            items: post.Sections,
=======
    var retrievedObject;

    localStorage.setItem('mydata', JSON.stringify(data.posts));

    var retrievedObject = localStorage.getItem('mydata');
    for (var i = 0; i < JSON.parse(retrievedObject).length; i++) {
        console.log('retrievedObject: ', JSON.parse(retrievedObject)[i].image);
    }




    JSON.parse(retrievedObject).forEach(function(post, i) {
        posts.push({
            id: i,
            title: post.title,
            text: post.text.substr(0, 250) + '...',
>>>>>>> aa34523e29c577f9f9d008989792a8efbe4fcdf1
            image: post.image
        });
    });
    res.json({
        posts: posts
    });
};

exports.post = function(req, res) {
    var id = req.params.id;
<<<<<<< HEAD
    localStorage.setItem('postId', id);
    if (id >= 0 && id < data.length) {
        res.json({
            post: data[id]
        });
        // console.log(data[id].Sections[0].)
    } else {
        res.json(true);
    }
};


// POST

exports.addPost = function(req, res) {
     data[req.body.post].Sections.push({
         "SectionName" : req.body.title,
         "SectionContent":req.body.text,
         "SectionNumber" : data[req.body.post].Sections.length + 1

     });
    fs.writeFile("../content.json", JSON.stringify(data) , function(err) {
        if(err) {
            return console.log(err);
        }

        console.log("The file was saved!");
    });
     res.json(req.body);
=======
    if (id >= 0 && id < data.posts.length) {
        res.json({
            post: data.posts[id]
        });
    } else {
        res.json(false);
    }
};

// POST

exports.addPost = function(req, res) {

    data.posts.push(req.body);

    res.json(req.body);
>>>>>>> aa34523e29c577f9f9d008989792a8efbe4fcdf1
};

// PUT

exports.editPost = function(req, res) {
    var id = req.params.id;

    if (id >= 0 && id < data.posts.length) {
        data.posts[id] = req.body;
        res.json(true);
    } else {
        res.json(false);
    }
};

// DELETE

exports.deletePost = function(req, res) {
    var id = req.params.id;

    if (id >= 0 && id < data.posts.length) {
        data.posts.splice(id, 1);
        res.json(true);
    } else {
        res.json(false);
    }
};
<<<<<<< HEAD

exports.item = function(req, res) {
    var id = req.params.id;
    var postId = localStorage.getItem('postId');
    localStorage.setItem('itemId',id);
    if (id >= 0 && id < data[postId].Sections.length) {
        res.json({
            item: data[postId].Sections[id]
        });
    } else {
        res.json(true);
    }
};

exports.editItem = function(req, res) {
    var postId = localStorage.getItem('postId');
    var id = req.params.id;
    if (id >= 0 && id < data[postId].Sections.length) {
        data[postId].Sections[id] = req.body;
        fs.writeFile("../content.json", JSON.stringify(data) , function(err) {
            if(err) {
                return console.log(err);
            }

            console.log("The file was saved!");
        });
        res.json(true);
    } else {
        res.json(false);
    }
};

exports.deleteItem = function(req, res) {
    var id = req.params.id;
    var postId = localStorage.getItem('postId');
    if (id >= 0 && id < data[postId].Sections.length) {
        data[postId].Sections.splice(id, 1);
        fs.writeFile("../content.json", JSON.stringify(data) , function(err) {
            if(err) {
                return console.log(err);
            }

            console.log("The file was saved!");
        });
        res.json(true);
    } else {
        res.json(false);
    }
};
=======
>>>>>>> aa34523e29c577f9f9d008989792a8efbe4fcdf1
